schema_version: 1.2.0
id: CVE-2021-43790
aliases:
- GHSA-hf79-8hjp-rrvq
modified: 2021-12-01T14:48Z
published: 2021-11-30T00:15Z
details: Lucet is a native WebAssembly compiler and runtime. There is a bug in the
  main branch of `lucet-runtime` affecting all versions published to crates.io that
  allows a use-after-free in an Instance object that could result in memory corruption,
  data race, or other related issues. This bug was introduced early in the development
  of Lucet and is present in all releases. As a result of this bug, and dependent
  on the memory backing for the Instance objects, it is possible to trigger a use-after-free
  when the Instance is dropped. Users should upgrade to the main branch of the Lucet
  repository. Lucet no longer provides versioned releases on crates.io. There is no
  way to remediate this vulnerability without upgrading.
severity:
- type: CVSS_V3
  score: 8.1
- type: CVSS_V2
  score: 6.8
affected:
- package:
    name: lucet
    cpe: cpe:2.3:a:bytecodealliance:lucet
- ranges:
  - type: GIT
    repo: https://github.com/bytecodealliance/lucet
    events:
    - introduced: '0'
    - fixed: 7c7757c772fb709c61b1442bcc1e1fbee97bf4a8
- database_specific:
    CWE:
    - CWE-416
    CVSS:
      Score: 8.1
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
- type: FIX
  url: https://github.com/bytecodealliance/lucet/commit/7c7757c772fb709c61b1442bcc1e1fbee97bf4a8
- type: WEB
  url: https://crates.io/crates/lucet-runtime
- type: ADVISORY
  url: https://github.com/bytecodealliance/lucet/security/advisories/GHSA-hf79-8hjp-rrvq
