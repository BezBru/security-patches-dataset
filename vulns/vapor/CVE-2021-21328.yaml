schema_version: 1.2.0
id: CVE-2021-21328
aliases:
- GHSA-gcj9-jj38-hwmc
modified: 2021-03-05T19:38Z
published: 2021-02-26T02:15Z
details: 'Vapor is a web framework for Swift. In Vapor before version 4.40.1, there
  is a DoS attack against anyone who Bootstraps a metrics backend for their Vapor
  app. The following is the attack vector: 1. send unlimited requests against a vapor
  instance with different paths. this will create unlimited counters and timers, which
  will eventually drain the system. 2. downstream services might suffer from this
  attack as well by being spammed with error paths. This has been patched in 4.40.1.
  The `DefaultResponder` will rewrite any undefined route paths for to `vapor_route_undefined`
  to avoid unlimited counters.'
severity:
- type: CVSS_V3
  score: 5.3
- type: CVSS_V2
  score: 5.0
affected:
- package:
    name: vapor
    cpe: cpe:2.3:a:vapor_project:vapor
- ranges:
  - type: GIT
    repo: https://github.com/vapor/vapor
    events:
    - introduced: '0'
    - fixed: e3aa712508db2854ac0ab905696c65fd88fa7e23
- database_specific:
    CWE:
    - CWE-400
    CVSS:
      Score: 5.3
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
references:
- type: WEB
  url: https://github.com/vapor/vapor/releases/tag/4.40.1
- type: WEB
  url: https://vapor.codes/
- type: ADVISORY
  url: https://github.com/vapor/vapor/security/advisories/GHSA-gcj9-jj38-hwmc
- type: FIX
  url: https://github.com/vapor/vapor/commit/e3aa712508db2854ac0ab905696c65fd88fa7e23
