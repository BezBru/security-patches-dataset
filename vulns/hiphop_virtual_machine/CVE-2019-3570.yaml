schema_version: 1.2.0
id: CVE-2019-3570
aliases: []
modified: 2020-10-16T15:14Z
published: 2019-07-18T16:15Z
details: Call to the scrypt_enc() function in HHVM can lead to heap corruption by
  using specifically crafted parameters (N, r and p). This happens if the parameters
  are configurable by an attacker for instance by providing the output of scrypt_enc()
  in a context where Hack/PHP code would attempt to verify it by re-running scrypt_enc()
  with the same parameters. This could result in information disclosure, memory being
  overwriten or crashes of the HHVM process. This issue affects versions 4.3.0, 4.4.0,
  4.5.0, 4.6.0, 4.7.0, 4.8.0, versions 3.30.5 and below, and all versions in the 4.0,
  4.1, and 4.2 series.
severity:
- type: CVSS_V3
  score: 9.8
- type: CVSS_V2
  score: 7.5
affected:
- package:
    name: hiphop_virtual_machine
    cpe: cpe:2.3:a:facebook:hiphop_virtual_machine
- ranges:
  - type: GIT
    repo: https://github.com/facebook/hhvm
    events:
    - introduced: '0'
    - fixed: cc331e4349e91706a673e2a09f1f2ea5bbb33815
- versions:
  - 4.4.0
  - 4.5.0
  - 4.7.0
  - 4.1.0
  - 4.2.0
  - 4.8.0
  - 4.3.0
  - 4.6.0
- database_specific:
    CWE:
    - CWE-787
    CVSS:
      Score: 9.8
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
- type: FIX
  url: https://github.com/facebook/hhvm/commit/cc331e4349e91706a673e2a09f1f2ea5bbb33815
- type: WEB
  url: https://hhvm.com/blog/2019/06/10/hhvm-4.9.0.html
