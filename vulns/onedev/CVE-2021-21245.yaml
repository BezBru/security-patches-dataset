schema_version: 1.2.0
id: CVE-2021-21245
aliases:
- GHSA-62m2-38q5-96w9
modified: 2021-01-21T15:02Z
published: 2021-01-15T21:15Z
details: OneDev is an all-in-one devops platform. In OneDev before version 4.0.3,
  AttachmentUploadServlet also saves user controlled data (`request.getInputStream()`)
  to a user specified location (`request.getHeader("File-Name")`). This issue may
  lead to arbitrary file upload which can be used to upload a WebShell to OneDev server.
  This issue is addressed in 4.0.3 by only allowing uploaded file to be in attachments
  folder. The webshell issue is not possible as OneDev never executes files in attachments
  folder.
severity:
- type: CVSS_V3
  score: 9.8
- type: CVSS_V2
  score: 7.5
affected:
- package:
    name: onedev
    cpe: cpe:2.3:a:onedev_project:onedev
- ranges:
  - type: GIT
    repo: https://github.com/theonedev/onedev
    events:
    - introduced: '0'
    - fixed: 0c060153fb97c0288a1917efdb17cc426934dacb
- database_specific:
    CWE:
    - CWE-434
    CVSS:
      Score: 9.8
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
- type: ADVISORY
  url: https://github.com/theonedev/onedev/security/advisories/GHSA-62m2-38q5-96w9
- type: FIX
  url: https://github.com/theonedev/onedev/commit/0c060153fb97c0288a1917efdb17cc426934dacb
