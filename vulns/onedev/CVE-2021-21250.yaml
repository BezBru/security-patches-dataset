schema_version: 1.2.0
id: CVE-2021-21250
aliases:
- GHSA-9pph-8gfc-6w2r
modified: 2021-01-21T14:28Z
published: 2021-01-15T21:15Z
details: OneDev is an all-in-one devops platform. In OneDev before version 4.0.3,
  there is a critical vulnerability which may lead to arbitrary file read. When BuildSpec
  is provided in XML format, the spec is processed by XmlBuildSpecMigrator.migrate(buildSpecString);
  which processes the XML document without preventing the expansion of external entities.
  These entities can be configured to read arbitrary files from the file system and
  dump their contents in the final XML document to be migrated. If the files are dumped
  in properties included in the YAML file, it will be possible for an attacker to
  read them. If not, it is possible for an attacker to exfiltrate the contents of
  these files Out Of Band. This issue was addressed in 4.0.3 by ignoring ENTITY instructions
  in xml file.
severity:
- type: CVSS_V3
  score: 6.5
- type: CVSS_V2
  score: 4.0
affected:
- package:
    name: onedev
    cpe: cpe:2.3:a:onedev_project:onedev
- ranges:
  - type: GIT
    repo: https://github.com/theonedev/onedev
    events:
    - introduced: '0'
    - fixed: 9196fd795e87dab069b4260a3590a0ea886e770f
- database_specific:
    CWE:
    - CWE-538
    CVSS:
      Score: 6.5
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
references:
- type: ADVISORY
  url: https://github.com/theonedev/onedev/security/advisories/GHSA-9pph-8gfc-6w2r
- type: FIX
  url: https://github.com/theonedev/onedev/commit/9196fd795e87dab069b4260a3590a0ea886e770f
