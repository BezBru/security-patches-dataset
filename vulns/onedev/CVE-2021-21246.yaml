schema_version: 1.2.0
id: CVE-2021-21246
aliases:
- GHSA-66v7-gg85-f4gx
modified: 2021-01-21T15:07Z
published: 2021-01-15T21:15Z
details: OneDev is an all-in-one devops platform. In OneDev before version 4.0.3,
  the REST UserResource endpoint performs a security check to make sure that only
  administrators can list user details. However for the `/users/{id}` endpoint there
  are no security checks enforced so it is possible to retrieve arbitrary user details
  including their Access Tokens! These access tokens can be used to access the API
  or clone code in the build spec via the HTTP(S) protocol. It has permissions to
  all projects accessible by the user account. This issue may lead to `Sensitive data
  leak` and leak the Access Token which can be used to impersonate the administrator
  or any other users. This issue was addressed in 4.0.3 by removing user info from
  restful api.
severity:
- type: CVSS_V3
  score: 7.5
- type: CVSS_V2
  score: 5.0
affected:
- package:
    name: onedev
    cpe: cpe:2.3:a:onedev_project:onedev
- ranges:
  - type: GIT
    repo: https://github.com/theonedev/onedev
    events:
    - introduced: '0'
    - fixed: a4491e5f79dc6cc96eac20972eedc8905ddf6089
- database_specific:
    CWE:
    - CWE-862
    CVSS:
      Score: 7.5
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
references:
- type: FIX
  url: https://github.com/theonedev/onedev/commit/a4491e5f79dc6cc96eac20972eedc8905ddf6089
- type: ADVISORY
  url: https://github.com/theonedev/onedev/security/advisories/GHSA-66v7-gg85-f4gx
