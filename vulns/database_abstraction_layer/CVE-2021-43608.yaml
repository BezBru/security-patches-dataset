schema_version: 1.2.0
id: CVE-2021-43608
aliases:
- GHSA-r7cj-8hjg-x622
modified: 2021-12-15T14:46Z
published: 2021-12-09T20:15Z
details: Doctrine DBAL 3.x before 3.1.4 allows SQL Injection. The escaping of offset
  and length inputs to the generation of a LIMIT clause was not probably cast to an
  integer, allowing SQL injection to take place if application developers passed unescaped
  user input to the DBAL QueryBuilder or any other API that ultimately uses the AbstractPlatform::modifyLimitQuery
  API.
severity:
- type: CVSS_V3
  score: 9.8
- type: CVSS_V2
  score: 7.5
affected:
- package:
    name: database_abstraction_layer
    cpe: cpe:2.3:a:doctrine-project:database_abstraction_layer
- ranges:
  - type: GIT
    repo: https://github.com/doctrine/dbal
    events:
    - introduced: '0'
    - fixed: 9dcfa4cb6c03250b78a84737ba7ceb82f4b7ba4d
- database_specific:
    CWE:
    - CWE-89
    CVSS:
      Score: 9.8
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
- type: FIX
  url: https://github.com/doctrine/dbal/commit/9dcfa4cb6c03250b78a84737ba7ceb82f4b7ba4d
- type: WEB
  url: https://github.com/doctrine/dbal/releases
- type: ADVISORY
  url: https://github.com/doctrine/dbal/security/advisories/GHSA-r7cj-8hjg-x622
- type: WEB
  url: https://www.doctrine-project.org/2021/11/11/dbal3-vulnerability-fixed.html
