schema_version: 1.2.0
id: CVE-2021-32804
aliases:
- GHSA-3jfq-g458-7qm9
modified: 2021-12-03T20:42Z
published: 2021-08-03T19:15Z
details: The npm package "tar" (aka node-tar) before versions 6.1.1, 5.0.6, 4.4.14,
  and 3.3.2 has a arbitrary File Creation/Overwrite vulnerability due to insufficient
  absolute path sanitization. node-tar aims to prevent extraction of absolute file
  paths by turning absolute paths into relative paths when the `preservePaths` flag
  is not set to `true`. This is achieved by stripping the absolute path root from
  any absolute file paths contained in a tar file. For example `/home/user/.bashrc`
  would turn into `home/user/.bashrc`. This logic was insufficient when file paths
  contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would
  only strip a single path root from such paths. When given an absolute file path
  with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would
  still resolve to an absolute path, thus allowing arbitrary file creation and overwrite.
  This issue was addressed in releases 3.2.2, 4.4.14, 5.0.6 and 6.1.1. Users may work
  around this vulnerability without upgrading by creating a custom `onentry` method
  which sanitizes the `entry.path` or a `filter` method which removes entries with
  absolute paths. See referenced GitHub Advisory for details. Be aware of CVE-2021-32803
  which fixes a similar bug in later versions of tar.
severity:
- type: CVSS_V3
  score: 8.1
- type: CVSS_V2
  score: 5.8
affected:
- package:
    name: tar
    cpe: cpe:2.3:a:tar_project:tar
- ranges:
  - type: GIT
    repo: https://github.com/npm/node-tar
    events:
    - introduced: '0'
    - fixed: 1f036ca23f64a547bdd6c79c1a44bc62e8115da4
- database_specific:
    CWE:
    - CWE-22
    CVSS:
      Score: 8.1
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
references:
- type: FIX
  url: https://github.com/npm/node-tar/commit/1f036ca23f64a547bdd6c79c1a44bc62e8115da4
- type: ADVISORY
  url: https://www.npmjs.com/advisories/1770
- type: ADVISORY
  url: https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9
- type: WEB
  url: https://www.npmjs.com/package/tar
- type: WEB
  url: https://www.oracle.com/security-alerts/cpuoct2021.html
