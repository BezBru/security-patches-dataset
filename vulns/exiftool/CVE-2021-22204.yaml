schema_version: 1.2.0
id: CVE-2021-22204
aliases: []
modified: 2021-11-29T21:06Z
published: 2021-04-23T18:15Z
details: Improper neutralization of user data in the DjVu file format in ExifTool
  versions 7.44 and up allows arbitrary code execution when parsing the malicious
  image
severity:
- type: CVSS_V3
  score: 7.8
- type: CVSS_V2
  score: 6.8
affected:
- package:
    name: exiftool
    cpe: cpe:2.3:a:exiftool_project:exiftool
- ranges:
  - type: GIT
    repo: https://github.com/exiftool/exiftool
    events:
    - introduced: '0'
    - fixed: cf0f4e7dcd024ca99615bfd1102a841a25dde031#diff-fa0d652d10dbcd246e6b1df16c1e992931d3bb717a7e36157596b76bdadb3800
- database_specific:
    CWE:
    - CWE-74
    CVSS:
      Score: 7.8
      Severity: HIGH
      Code: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
references:
- type: WEB
  url: https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22204.json
- type: WEB
  url: https://lists.debian.org/debian-lts-announce/2021/05/msg00018.html
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/U4RF6PJCJ6NQOVJJJF6HN6BORUQVIXY6/
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/F6UOBPU3LSHAPRRJNISNVXZ5DSUIALLV/
- type: WEB
  url: http://packetstormsecurity.com/files/164768/GitLab-Unauthenticated-Remote-ExifTool-Command-Injection.html
- type: WEB
  url: http://packetstormsecurity.com/files/164994/GitLab-13.10.2-Remote-Code-Execution.html
- type: ADVISORY
  url: https://www.debian.org/security/2021/dsa-4910
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DDKDLJLBTBBR66OOPXSXCG2PQRM5KCZL/
- type: WEB
  url: http://www.openwall.com/lists/oss-security/2021/05/10/5
- type: WEB
  url: http://packetstormsecurity.com/files/162558/ExifTool-DjVu-ANT-Perl-Injection.html
- type: WEB
  url: http://www.openwall.com/lists/oss-security/2021/05/09/1
- type: FIX
  url: https://github.com/exiftool/exiftool/commit/cf0f4e7dcd024ca99615bfd1102a841a25dde031#diff-fa0d652d10dbcd246e6b1df16c1e992931d3bb717a7e36157596b76bdadb3800
- type: WEB
  url: https://hackerone.com/reports/1154542
