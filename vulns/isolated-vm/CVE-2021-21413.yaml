schema_version: 1.2.0
id: CVE-2021-21413
aliases:
- GHSA-mmhj-4w6j-76h7
modified: 2021-04-07T14:56Z
published: 2021-03-30T23:15Z
details: isolated-vm is a library for nodejs which gives you access to v8's Isolate
  interface. Versions of isolated-vm before v4.0.0 have API pitfalls which may make
  it easy for implementers to expose supposed secure isolates to the permissions of
  the main nodejs isolate. Reference objects allow access to the underlying reference's
  full prototype chain. In an environment where the implementer has exposed a Reference
  instance to an attacker they would be able to use it to acquire a Reference to the
  nodejs context's Function object. Similar application-specific attacks could be
  possible by modifying the local prototype of other API objects. Access to NativeModule
  objects could allow an attacker to load and run native code from anywhere on the
  filesystem. If combined with, for example, a file upload API this would allow for
  arbitrary code execution. This is addressed in v4.0.0 through a series of related
  changes.
severity:
- type: CVSS_V3
  score: 9.6
- type: CVSS_V2
  score: 5.8
affected:
- package:
    name: isolated-vm
    cpe: cpe:2.3:a:isolated-vm_project:isolated-vm
- ranges:
  - type: GIT
    repo: https://github.com/laverdet/isolated-vm
    events:
    - introduced: '0'
    - fixed: 27151bfecc260e96714443613880e3b2e6596704
  - type: GIT
    repo: https://github.com/laverdet/isolated-vm
    events:
    - introduced: '0'
    - fixed: 2646e6c1558bac66285daeab54c7d490ed332b15
- database_specific:
    CWE:
    - CWE-913
    CVSS:
      Score: 9.6
      Severity: CRITICAL
      Code: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
references:
- type: WEB
  url: https://github.com/laverdet/isolated-vm/blob/main/CHANGELOG.md#v400
- type: FIX
  url: https://github.com/laverdet/isolated-vm/commit/27151bfecc260e96714443613880e3b2e6596704
- type: ADVISORY
  url: https://github.com/laverdet/isolated-vm/security/advisories/GHSA-mmhj-4w6j-76h7
- type: FIX
  url: https://github.com/laverdet/isolated-vm/commit/2646e6c1558bac66285daeab54c7d490ed332b15
