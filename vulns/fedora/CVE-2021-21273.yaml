schema_version: 1.2.0
id: CVE-2021-21273
aliases:
- GHSA-v936-j8gp-9q3p
modified: 2021-11-23T22:27Z
published: 2021-02-26T18:15Z
details: Synapse is a Matrix reference homeserver written in python (pypi package
  matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and
  VoIP. In Synapse before version 1.25.0, requests to user provided domains were not
  restricted to external IP addresses when calculating the key validity for third-party
  invite events and sending push notifications. This could cause Synapse to make requests
  to internal infrastructure. The type of request was not controlled by the user,
  although limited modification of request bodies was possible. For the most thorough
  protection server administrators should remove the deprecated `federation_ip_range_blacklist`
  from their settings after upgrading to Synapse v1.25.0 which will result in Synapse
  using the improved default IP address restrictions. See the new `ip_range_blacklist`
  and `ip_range_whitelist` settings if more specific control is necessary.
severity:
- type: CVSS_V3
  score: 6.1
- type: CVSS_V2
  score: 5.8
affected:
- package:
    name: fedora
    cpe: cpe:2.3:o:fedoraproject:fedora
- ranges:
  - type: GIT
    repo: https://github.com/matrix-org/synapse
    events:
    - introduced: '0'
    - fixed: 30fba6210834a4ecd91badf0c8f3eb278b72e746
- versions:
  - '34'
- database_specific:
    CWE:
    - CWE-601
    - CWE-601
    CVSS:
      Score: 6.1
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
references:
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY/
- type: WEB
  url: https://github.com/matrix-org/synapse/pull/8821
- type: WEB
  url: https://github.com/matrix-org/synapse/releases/tag/v1.25.0
- type: ADVISORY
  url: https://github.com/matrix-org/synapse/security/advisories/GHSA-v936-j8gp-9q3p
- type: FIX
  url: https://github.com/matrix-org/synapse/commit/30fba6210834a4ecd91badf0c8f3eb278b72e746
