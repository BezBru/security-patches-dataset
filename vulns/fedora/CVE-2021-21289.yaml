schema_version: 1.2.0
id: CVE-2021-21289
aliases:
- GHSA-qrqm-fpv6-6r8g
modified: 2021-07-08T07:15Z
published: 2021-02-02T19:15Z
details: 'Mechanize is an open-source ruby library that makes automated web interaction
  easy. In Mechanize from version 2.0.0 and before version 2.7.7 there is a command
  injection vulnerability. Affected versions of mechanize allow for OS commands to
  be injected using several classes'' methods which implicitly use Ruby''s Kernel.open
  method. Exploitation is possible only if untrusted input is used as a local filename
  and passed to any of these calls: Mechanize::CookieJar#load, Mechanize::CookieJar#save_as,
  Mechanize#download, Mechanize::Download#save, Mechanize::File#save, and Mechanize::FileResponse#read_body.
  This is fixed in version 2.7.7.'
severity:
- type: CVSS_V3
  score: 8.3
- type: CVSS_V2
  score: 7.6
affected:
- package:
    name: fedora
    cpe: cpe:2.3:o:fedoraproject:fedora
- ranges:
  - type: GIT
    repo: https://github.com/sparklemotion/mechanize
    events:
    - introduced: '0'
    - fixed: 66a6a1bfa653a5f13274a396a5e5441238656aa0
- versions:
  - '33'
  - '32'
- database_specific:
    CWE:
    - CWE-78
    CVSS:
      Score: 8.3
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
references:
- type: WEB
  url: https://rubygems.org/gems/mechanize/
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YNFZ7ROYS6V4J5L5PRAJUG2AWC7VXR2V/
- type: WEB
  url: https://lists.debian.org/debian-lts-announce/2021/02/msg00021.html
- type: FIX
  url: https://github.com/sparklemotion/mechanize/commit/66a6a1bfa653a5f13274a396a5e5441238656aa0
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LBVVJUL4P4KCJH4IQTHFZ4ATXY7XXZPV/
- type: WEB
  url: https://github.com/sparklemotion/mechanize/releases/tag/v2.7.7
- type: ADVISORY
  url: https://github.com/sparklemotion/mechanize/security/advisories/GHSA-qrqm-fpv6-6r8g
- type: WEB
  url: https://security.gentoo.org/glsa/202107-17
