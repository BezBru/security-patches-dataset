schema_version: 1.2.0
id: CVE-2021-40153
aliases: []
modified: 2021-10-07T17:48Z
published: 2021-08-27T15:15Z
details: squashfs_opendir in unsquash-1.c in Squashfs-Tools 4.5 stores the filename
  in the directory entry; this is then used by unsquashfs to create the new file during
  the unsquash. The filename is not validated for traversal outside of the destination
  directory, and thus allows writing to locations outside of the destination.
severity:
- type: CVSS_V3
  score: 8.1
- type: CVSS_V2
  score: 5.8
affected:
- package:
    name: squashfs-tools
    cpe: cpe:2.3:a:squashfs-tools_project:squashfs-tools
- ranges:
  - type: GIT
    repo: https://github.com/plougher/squashfs-tools
    events:
    - introduced: '0'
    - fixed: 79b5a555058eef4e1e7ff220c344d39f8cd09646
- versions:
  - '4.5'
- database_specific:
    CWE:
    - CWE-22
    CVSS:
      Score: 8.1
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
references:
- type: ADVISORY
  url: https://www.debian.org/security/2021/dsa-4967
- type: REPORT
  url: https://bugs.launchpad.net/ubuntu/+source/squashfs-tools/+bug/1941790
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RAOZ4BKWAC4Y3U2K5MMW3S77HWWXHQDL/
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GSMRKVJMJFX3MB7D3PXJSYY3TLZROE5S/
- type: FIX
  url: https://github.com/plougher/squashfs-tools/commit/79b5a555058eef4e1e7ff220c344d39f8cd09646
- type: REPORT
  url: https://github.com/plougher/squashfs-tools/issues/72
- type: WEB
  url: https://lists.debian.org/debian-lts-announce/2021/08/msg00030.html
