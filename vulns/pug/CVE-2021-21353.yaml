schema_version: 1.2.0
id: CVE-2021-21353
aliases:
- GHSA-p493-635q-r6gr
modified: 2021-03-09T15:35Z
published: 2021-03-03T02:15Z
details: Pug is an npm package which is a high-performance template engine. In pug
  before version 3.0.1, if a remote attacker was able to control the `pretty` option
  of the pug compiler, e.g. if you spread a user provided object such as the query
  parameters of a request into the pug template inputs, it was possible for them to
  achieve remote code execution on the node.js backend. This is fixed in version 3.0.1.
  This advisory applies to multiple pug packages including "pug", "pug-code-gen".
  pug-code-gen has a backported fix at version 2.0.3. This advisory is not exploitable
  if there is no way for un-trusted input to be passed to pug as the `pretty` option,
  e.g. if you compile templates in advance before applying user input to them, you
  do not need to upgrade.
severity:
- type: CVSS_V3
  score: 9.0
- type: CVSS_V2
  score: 6.8
affected:
- package:
    name: pug
    cpe: cpe:2.3:a:pugjs:pug
- ranges:
  - type: GIT
    repo: https://github.com/pugjs/pug
    events:
    - introduced: '0'
    - fixed: 991e78f7c4220b2f8da042877c6f0ef5a4683be0
- database_specific:
    CWE:
    - CWE-74
    CVSS:
      Score: 9.0
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
references:
- type: WEB
  url: https://www.npmjs.com/package/pug-code-gen
- type: WEB
  url: https://github.com/pugjs/pug/releases/tag/pug%403.0.1
- type: WEB
  url: https://github.com/pugjs/pug/pull/3314
- type: ADVISORY
  url: https://github.com/pugjs/pug/security/advisories/GHSA-p493-635q-r6gr
- type: FIX
  url: https://github.com/pugjs/pug/commit/991e78f7c4220b2f8da042877c6f0ef5a4683be0
- type: WEB
  url: https://www.npmjs.com/package/pug
- type: REPORT
  url: https://github.com/pugjs/pug/issues/3312
