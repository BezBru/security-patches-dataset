schema_version: 1.2.0
id: CVE-2021-41106
aliases:
- GHSA-7322-jrq4-x5hf
modified: 2021-10-07T16:22Z
published: 2021-09-28T21:15Z
details: JWT is a library to work with JSON Web Token and JSON Web Signature. Prior
  to versions 3.4.6, 4.0.4, and 4.1.5, users of HMAC-based algorithms (HS256, HS384,
  and HS512) combined with `Lcobucci\JWT\Signer\Key\LocalFileReference` as key are
  having their tokens issued/validated using the file path as hashing key - instead
  of the contents. The HMAC hashing functions take any string as input and, since
  users can issue and validate tokens, users are lead to believe that everything works
  properly. Versions 3.4.6, 4.0.4, and 4.1.5 have been patched to always load the
  file contents, deprecated the `Lcobucci\JWT\Signer\Key\LocalFileReference`, and
  suggest `Lcobucci\JWT\Signer\Key\InMemory` as the alternative. As a workaround,
  use `Lcobucci\JWT\Signer\Key\InMemory` instead of `Lcobucci\JWT\Signer\Key\LocalFileReference`
  to create the instances of one's keys.
severity:
- type: CVSS_V3
  score: 3.3
- type: CVSS_V2
  score: 2.1
affected:
- package:
    name: jwt
    cpe: cpe:2.3:a:jwt_project:jwt
- ranges:
  - type: GIT
    repo: https://github.com/lcobucci/jwt
    events:
    - introduced: '0'
    - fixed: 8175de5b841fbe3fd97d2d49b3fc15c4ecb39a73
  - type: GIT
    repo: https://github.com/lcobucci/jwt
    events:
    - introduced: '0'
    - fixed: c45bb8b961a8e742d8f6b88ef5ff1bd5cca5d01c
- database_specific:
    CWE:
    - CWE-345
    CVSS:
      Score: 3.3
      Severity: LOW
      Code: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
references:
- type: ADVISORY
  url: https://github.com/lcobucci/jwt/security/advisories/GHSA-7322-jrq4-x5hf
- type: FIX
  url: https://github.com/lcobucci/jwt/commit/8175de5b841fbe3fd97d2d49b3fc15c4ecb39a73
- type: FIX
  url: https://github.com/lcobucci/jwt/commit/c45bb8b961a8e742d8f6b88ef5ff1bd5cca5d01c
