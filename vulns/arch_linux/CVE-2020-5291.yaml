schema_version: 1.2.0
id: CVE-2020-5291
aliases:
- GHSA-j2qp-rvxj-43vj
modified: 2020-04-02T17:33Z
published: 2020-03-31T18:15Z
details: 'Bubblewrap (bwrap) before version 0.4.1, if installed in setuid mode and
  the kernel supports unprivileged user namespaces, then the `bwrap --userns2` option
  can be used to make the setuid process keep running as root while being traceable.
  This can in turn be used to gain root permissions. Note that this only affects the
  combination of bubblewrap in setuid mode (which is typically used when unprivileged
  user namespaces are not supported) and the support of unprivileged user namespaces.
  Known to be affected are: * Debian testing/unstable, if unprivileged user namespaces
  enabled (not default) * Debian buster-backports, if unprivileged user namespaces
  enabled (not default) * Arch if using `linux-hardened`, if unprivileged user namespaces
  enabled (not default) * Centos 7 flatpak COPR, if unprivileged user namespaces enabled
  (not default) This has been fixed in the 0.4.1 release, and all affected users should
  update.'
severity:
- type: CVSS_V3
  score: 7.8
- type: CVSS_V2
  score: 8.5
affected:
- package:
    name: arch_linux
    cpe: cpe:2.3:o:archlinux:arch_linux
- ranges:
  - type: GIT
    repo: https://github.com/containers/bubblewrap
    events:
    - introduced: '0'
    - fixed: 1f7e2ad948c051054b683461885a0215f1806240
- database_specific:
    CWE:
    - CWE-269
    CVSS:
      Score: 7.8
      Severity: HIGH
      Code: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
references:
- type: ADVISORY
  url: https://github.com/containers/bubblewrap/security/advisories/GHSA-j2qp-rvxj-43vj
- type: FIX
  url: https://github.com/containers/bubblewrap/commit/1f7e2ad948c051054b683461885a0215f1806240
