schema_version: 1.2.0
id: CVE-2021-21309
aliases:
- GHSA-hgj8-vff2-7cjf
modified: 2021-03-31T14:15Z
published: 2021-02-26T22:15Z
details: "Redis is an open-source, in-memory database that persists on disk. In affected\
  \ versions of Redis an integer overflow bug in 32-bit Redis version 4.0 or newer\
  \ could be exploited to corrupt the heap and potentially result with remote code\
  \ execution. Redis 4.0 or newer uses a configurable limit for the maximum supported\
  \ bulk input size. By default, it is 512MB which is a safe value for all platforms.\
  \ If the limit is significantly increased, receiving a large request from a client\
  \ may trigger several integer overflow scenarios, which would result with buffer\
  \ overflow and heap corruption. We believe this could in certain conditions be exploited\
  \ for remote code execution. By default, authenticated Redis users have access to\
  \ all configuration parameters and can therefore use the \u201CCONFIG SET proto-max-bulk-len\u201D\
  \ to change the safe default, making the system vulnerable. **This problem only\
  \ affects 32-bit Redis (on a 32-bit system, or as a 32-bit executable running on\
  \ a 64-bit system).** The problem is fixed in version 6.2, and the fix is back ported\
  \ to 6.0.11 and 5.0.11. Make sure you use one of these versions if you are running\
  \ 32-bit Redis. An additional workaround to mitigate the problem without patching\
  \ the redis-server executable is to prevent clients from directly executing `CONFIG\
  \ SET`: Using Redis 6.0 or newer, ACL configuration can be used to block the command.\
  \ Using older versions, the `rename-command` configuration directive can be used\
  \ to rename the command to a random string unknown to users, rendering it inaccessible.\
  \ Please note that this workaround may have an additional impact on users or operational\
  \ systems that expect `CONFIG SET` to behave in certain ways."
severity:
- type: CVSS_V3
  score: 8.8
- type: CVSS_V2
  score: 6.5
affected:
- package:
    name: redis
    cpe: cpe:2.3:a:redislabs:redis
- ranges:
  - type: GIT
    repo: https://github.com/redis/redis
    events:
    - introduced: '0'
    - fixed: c992857618db99776917f10bf4f2345a5fdc78b0
- database_specific:
    CWE:
    - CWE-190
    CVSS:
      Score: 8.8
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
references:
- type: ADVISORY
  url: https://github.com/redis/redis/security/advisories/GHSA-hgj8-vff2-7cjf
- type: WEB
  url: https://github.com/redis/redis/pull/8522
- type: FIX
  url: https://github.com/redis/redis/commit/c992857618db99776917f10bf4f2345a5fdc78b0
- type: WEB
  url: https://security.gentoo.org/glsa/202103-02
