schema_version: 1.2.0
id: CVE-2017-12154
aliases: []
modified: 2019-10-03T00:03Z
published: 2017-09-26T05:29Z
details: The prepare_vmcs02 function in arch/x86/kvm/vmx.c in the Linux kernel through
  4.13.3 does not ensure that the "CR8-load exiting" and "CR8-store exiting" L0 vmcs02
  controls exist in cases where L1 omits the "use TPR shadow" vmcs12 control, which
  allows KVM L2 guest OS users to obtain read and write access to the hardware CR8
  register.
severity:
- type: CVSS_V3
  score: 7.1
- type: CVSS_V2
  score: 3.6
affected:
- package:
    name: linux_kernel
    cpe: cpe:2.3:o:linux:linux_kernel
- ranges:
  - type: GIT
    repo: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git
    events:
    - introduced: '0'
    - fixed: 51aa68e7d57e3217192d88ce90fd5b8ef29ec94f
  - type: GIT
    repo: https://github.com/torvalds/linux
    events:
    - introduced: '0'
    - fixed: 51aa68e7d57e3217192d88ce90fd5b8ef29ec94f
- database_specific:
    CWE:
    - NVD-CWE-noinfo
    CVSS:
      Score: 7.1
      Severity: HIGH
      Code: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
references:
- type: FIX
  url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=51aa68e7d57e3217192d88ce90fd5b8ef29ec94f
- type: WEB
  url: https://usn.ubuntu.com/3698-1/
- type: WEB
  url: http://www.securityfocus.com/bid/100856
- type: REPORT
  url: https://bugzilla.redhat.com/show_bug.cgi?id=1491224
- type: WEB
  url: https://access.redhat.com/errata/RHSA-2018:0676
- type: WEB
  url: https://access.redhat.com/errata/RHSA-2018:1062
- type: WEB
  url: https://access.redhat.com/errata/RHSA-2019:1946
- type: ADVISORY
  url: http://www.debian.org/security/2017/dsa-3981
- type: WEB
  url: https://www.spinics.net/lists/kvm/msg155414.html
- type: WEB
  url: https://usn.ubuntu.com/3698-2/
- type: FIX
  url: https://github.com/torvalds/linux/commit/51aa68e7d57e3217192d88ce90fd5b8ef29ec94f
