schema_version: 1.2.0
id: CVE-2020-15239
aliases:
- GHSA-hwv5-w8gm-fq9f
modified: 2020-10-23T03:09Z
published: 2020-10-06T19:15Z
details: In xmpp-http-upload before version 0.4.0, when the GET method is attacked,
  attackers can read files which have a `.data` suffix and which are accompanied by
  a JSON file with the `.meta` suffix. This can lead to Information Disclosure and
  in some shared-hosting scenarios also to circumvention of authentication or other
  limitations on the outbound (GET) traffic. For example, in a scenario where a single
  server has multiple instances of the application running (with separate DATA_ROOT
  settings), an attacker who has knowledge about the directory structure is able to
  read files from any other instance to which the process has read access. If instances
  have individual authentication (for example, HTTP authentication via a reverse proxy,
  source IP based filtering) or other restrictions (such as quotas), attackers may
  circumvent those limits in such a scenario by using the Directory Traversal to retrieve
  data from the other instances. If the associated XMPP server (or anyone knowing
  the SECRET_KEY) is malicious, they can write files outside the DATA_ROOT. The files
  which are written are constrained to have the `.meta` and the `.data` suffixes;
  the `.meta` file will contain the JSON with the Content-Type of the original request
  and the `.data` file will contain the payload. The issue is patched in version 0.4.0.
severity:
- type: CVSS_V3
  score: 3.5
- type: CVSS_V2
  score: 4.0
affected:
- package:
    name: xmpp-http-upload
    cpe: cpe:2.3:a:xmpp-http-upload_project:xmpp-http-upload
- ranges:
  - type: GIT
    repo: https://github.com/horazont/xmpp-http-upload
    events:
    - introduced: '0'
    - fixed: 82056540191e89f0cd697c81f57714c00962ed75
- database_specific:
    CWE:
    - CWE-22
    CVSS:
      Score: 3.5
      Severity: LOW
      Code: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
references:
- type: WEB
  url: https://pypi.org/project/xmpp-http-upload/#history
- type: ADVISORY
  url: https://github.com/horazont/xmpp-http-upload/security/advisories/GHSA-hwv5-w8gm-fq9f
- type: WEB
  url: https://github.com/horazont/xmpp-http-upload/pull/12
- type: FIX
  url: https://github.com/horazont/xmpp-http-upload/commit/82056540191e89f0cd697c81f57714c00962ed75
