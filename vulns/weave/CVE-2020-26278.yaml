schema_version: 1.2.0
id: CVE-2020-26278
aliases:
- GHSA-pg3p-v8c6-c6h3
modified: 2021-02-02T15:26Z
published: 2021-01-20T22:15Z
details: 'Weave Net is open source software which creates a virtual network that connects
  Docker containers across multiple hosts and enables their automatic discovery. Weave
  Net before version 2.8.0 has a vulnerability in which can allow an attacker to take
  over any host in the cluster. Weave Net is supplied with a manifest that runs pods
  on every node in a Kubernetes cluster, which are responsible for managing network
  connections for all other pods in the cluster. This requires a lot of power over
  the host, and the manifest sets `privileged: true`, which gives it that power. It
  also set `hostPID: true`, which gave it the ability to access all other processes
  on the host, and write anywhere in the root filesystem of the host. This setting
  was not necessary, and is being removed. You are only vulnerable if you have an
  additional vulnerability (e.g. a bug in Kubernetes) or misconfiguration that allows
  an attacker to run code inside the Weave Net pod, No such bug is known at the time
  of release, and there are no known instances of this being exploited. Weave Net
  2.8.0 removes the hostPID setting and moves CNI plugin install to an init container.
  Users who do not update to 2.8.0 can edit the hostPID line in their existing DaemonSet
  manifest to say false instead of true, arrange some other way to install CNI plugins
  (e.g. Ansible) and remove those mounts from the DaemonSet manifest.'
severity:
- type: CVSS_V3
  score: 8.0
- type: CVSS_V2
  score: 7.9
affected:
- package:
    name: weave
    cpe: cpe:2.3:a:weave:weave
- ranges:
  - type: GIT
    repo: https://github.com/weaveworks/weave
    events:
    - introduced: '0'
    - fixed: a0ac81b3b4cae6d0dcaf3732fd91cedefc89f720
- database_specific:
    CWE:
    - CWE-250
    CVSS:
      Score: 8.0
      Severity: HIGH
      Code: CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
references:
- type: WEB
  url: https://github.com/weaveworks/weave/pull/3876
- type: FIX
  url: https://github.com/weaveworks/weave/commit/a0ac81b3b4cae6d0dcaf3732fd91cedefc89f720
- type: WEB
  url: https://github.com/weaveworks/weave/blob/master/CHANGELOG.md#release-280
- type: ADVISORY
  url: https://github.com/weaveworks/weave/security/advisories/GHSA-pg3p-v8c6-c6h3
