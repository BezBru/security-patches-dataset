schema_version: 1.2.0
id: CVE-2021-21334
aliases:
- GHSA-6g2q-w5j3-fwh4
modified: 2021-05-26T12:15Z
published: 2021-03-10T22:15Z
details: In containerd (an industry-standard container runtime) before versions 1.3.10
  and 1.4.4, containers launched through containerd's CRI implementation (through
  Kubernetes, crictl, or any other pod/container client that uses the containerd CRI
  service) that share the same image may receive incorrect environment variables,
  including values that are defined for other containers. If the affected containers
  have different security contexts, this may allow sensitive information to be unintentionally
  shared. If you are not using containerd's CRI implementation (through one of the
  mechanisms described above), you are not vulnerable to this issue. If you are not
  launching multiple containers or Kubernetes pods from the same image which have
  different environment variables, you are not vulnerable to this issue. If you are
  not launching multiple containers or Kubernetes pods from the same image in rapid
  succession, you have reduced likelihood of being vulnerable to this issue This vulnerability
  has been fixed in containerd 1.3.10 and containerd 1.4.4. Users should update to
  these versions.
severity:
- type: CVSS_V3
  score: 6.3
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: containerd
    cpe: cpe:2.3:a:linuxfoundation:containerd
- ranges:
  - type: GIT
    repo: https://github.com/containerd/containerd
    events:
    - introduced: '0'
    - fixed: 05f951a3781f4f2c1911b05e61c160e9c30eaa8e
- database_specific:
    CWE:
    - CWE-668
    CVSS:
      Score: 6.3
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N
references:
- type: FIX
  url: https://github.com/containerd/containerd/commit/05f951a3781f4f2c1911b05e61c160e9c30eaa8e
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KUE2Z2ZUWBHRU36ZGBD2YSJCYB6ELPXE/
- type: WEB
  url: https://github.com/containerd/containerd/releases/tag/v1.3.10
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QIBPKSX5IOWPM3ZPFB3JVLXWDHSZTTWT/
- type: WEB
  url: https://security.gentoo.org/glsa/202105-33
- type: WEB
  url: https://github.com/containerd/containerd/releases/tag/v1.4.4
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VTXHA5JOWQRCCUZH7ZQBEYN6KZKJEYSD/
- type: ADVISORY
  url: https://github.com/containerd/containerd/security/advisories/GHSA-6g2q-w5j3-fwh4
