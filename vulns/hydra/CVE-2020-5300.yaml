schema_version: 1.2.0
id: CVE-2020-5300
aliases:
- GHSA-3p3g-vpw6-4w66
modified: 2020-04-07T13:52Z
published: 2020-04-06T17:15Z
details: "In Hydra (an OAuth2 Server and OpenID Certified\u2122 OpenID Connect Provider\
  \ written in Go), before version 1.4.0+oryOS.17, when using client authentication\
  \ method 'private_key_jwt' [1], OpenId specification says the following about assertion\
  \ `jti`: \"A unique identifier for the token, which can be used to prevent reuse\
  \ of the token. These tokens MUST only be used once, unless conditions for reuse\
  \ were negotiated between the parties\". Hydra does not check the uniqueness of\
  \ this `jti` value. Exploiting this vulnerability is somewhat difficult because:\
  \ - TLS protects against MITM which makes it difficult to intercept valid tokens\
  \ for replay attacks - The expiry time of the JWT gives only a short window of opportunity\
  \ where it could be replayed This has been patched in version v1.4.0+oryOS.17"
severity:
- type: CVSS_V3
  score: 5.3
- type: CVSS_V2
  score: 3.5
affected:
- package:
    name: hydra
    cpe: cpe:2.3:a:ory:hydra
- ranges:
  - type: GIT
    repo: https://github.com/ory/hydra
    events:
    - introduced: '0'
    - fixed: 700d17d3b7d507de1b1d459a7261d6fb2571ebe3
- database_specific:
    CWE:
    - CWE-294
    CVSS:
      Score: 5.3
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
references:
- type: ADVISORY
  url: https://github.com/ory/hydra/security/advisories/GHSA-3p3g-vpw6-4w66
- type: WEB
  url: https://github.com/ory/hydra/releases/tag/v1.4.0
- type: FIX
  url: https://github.com/ory/hydra/commit/700d17d3b7d507de1b1d459a7261d6fb2571ebe3
