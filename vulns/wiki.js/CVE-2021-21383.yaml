schema_version: 1.2.0
id: CVE-2021-21383
aliases:
- GHSA-6xx4-m8gx-826r
modified: 2021-03-24T14:00Z
published: 2021-03-18T17:15Z
details: Wiki.js an open-source wiki app built on Node.js. Wiki.js before version
  2.5.191 is vulnerable to stored cross-site scripting through mustache expressions
  in code blocks. This vulnerability exists due to mustache expressions being parsed
  by Vue during content injection even though it is contained within a `<pre>` element.
  By creating a crafted wiki page, a malicious Wiki.js user may stage a stored cross-site
  scripting attack. This allows the attacker to execute malicious JavaScript when
  the page is viewed by other users. For an example see referenced GitHub Security
  Advisory. Commit 5ffa189383dd716f12b56b8cae2ba0d075996cf1 fixes this vulnerability
  by adding the v-pre directive to all `<pre>` tags during the render.
severity:
- type: CVSS_V3
  score: 5.4
- type: CVSS_V2
  score: 3.5
affected:
- package:
    name: wiki.js
    cpe: cpe:2.3:a:requarks:wiki.js
- ranges:
  - type: GIT
    repo: https://github.com/Requarks/wiki
    events:
    - introduced: '0'
    - fixed: 5ffa189383dd716f12b56b8cae2ba0d075996cf1
- database_specific:
    CWE:
    - CWE-79
    CVSS:
      Score: 5.4
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
references:
- type: WEB
  url: https://github.com/Requarks/wiki/releases/tag/2.5.191
- type: FIX
  url: https://github.com/Requarks/wiki/commit/5ffa189383dd716f12b56b8cae2ba0d075996cf1
- type: ADVISORY
  url: https://github.com/Requarks/wiki/security/advisories/GHSA-6xx4-m8gx-826r
