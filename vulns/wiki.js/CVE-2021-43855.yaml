schema_version: 1.2.0
id: CVE-2021-43855
aliases:
- GHSA-4893-pj5w-3hq9
modified: 2022-01-07T14:01Z
published: 2021-12-27T18:15Z
details: Wiki.js is a wiki app built on node.js. Wiki.js 2.5.263 and earlier is vulnerable
  to stored cross-site scripting through a SVG file upload made via a custom request
  with a fake MIME type. By creating a crafted SVG file, a malicious Wiki.js user
  may stage a stored cross-site scripting attack. This allows the attacker to execute
  malicious JavaScript when the SVG is viewed directly by other users. Scripts do
  not execute when loaded inside a page via normal `<img>` tags. The malicious SVG
  can only be uploaded by crafting a custom request to the server with a fake MIME
  type. A patch in version 2.5.264 fixes this vulnerability by adding an additional
  file extension verification check to the optional (enabled by default) SVG sanitization
  step to all file uploads that match the SVG mime type. As a workaround, disable
  file upload for all non-trusted users.
severity:
- type: CVSS_V3
  score: 5.4
- type: CVSS_V2
  score: 3.5
affected:
- package:
    name: wiki.js
    cpe: cpe:2.3:a:requarks:wiki.js
- ranges:
  - type: GIT
    repo: https://github.com/Requarks/wiki
    events:
    - introduced: '0'
    - fixed: 57b56d3a5b9c00358814e76f3ee5b4bb353ad62f
- database_specific:
    CWE:
    - CWE-79
    CVSS:
      Score: 5.4
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
references:
- type: ADVISORY
  url: https://github.com/Requarks/wiki/security/advisories/GHSA-4893-pj5w-3hq9
- type: FIX
  url: https://github.com/Requarks/wiki/commit/57b56d3a5b9c00358814e76f3ee5b4bb353ad62f
- type: WEB
  url: https://github.com/Requarks/wiki/releases/tag/2.5.264
