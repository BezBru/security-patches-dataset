schema_version: 1.2.0
id: CVE-2021-32643
aliases:
- GHSA-6h7w-fc84-x7p6
modified: 2021-06-10T13:32Z
published: 2021-05-27T18:15Z
details: 'Http4s is a Scala interface for HTTP services. `StaticFile.fromUrl` can
  leak the presence of a directory on a server when the `URL` scheme is not `file://`,
  and the URL points to a fetchable resource under its scheme and authority. The function
  returns `F[None]`, indicating no resource, if `url.getFile` is a directory, without
  first checking the scheme or authority of the URL. If a URL connection to the scheme
  and URL would return a stream, and the path in the URL exists as a directory on
  the server, the presence of the directory on the server could be inferred from the
  404 response. The contents and other metadata about the directory are not exposed.
  This affects http4s versions: 0.21.7 through 0.21.23, 0.22.0-M1 through 0.22.0-M8,
  0.23.0-M1, and 1.0.0-M1 through 1.0.0-M22. The [patch](https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9)
  is available in the following versions: v0.21.24, v0.22.0-M9, v0.23.0-M2, v1.0.0-M23.
  As a workaround users can avoid calling `StaticFile.fromUrl` with non-file URLs.'
severity:
- type: CVSS_V3
  score: 5.8
- type: CVSS_V2
  score: 5.0
affected:
- package:
    name: http4s
    cpe: cpe:2.3:a:typelevel:http4s
- ranges:
  - type: GIT
    repo: https://github.com/http4s/http4s
    events:
    - introduced: '0'
    - fixed: 52e1890665410b4385e37b96bc49c5e3c708e4e9
- versions:
  - 0.23.0
  - 0.22.0
  - 1.0.0
- database_specific:
    CWE:
    - CWE-22
    CVSS:
      Score: 5.8
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
references:
- type: WEB
  url: https://mvnrepository.com/artifact/org.http4s/http4s-core
- type: ADVISORY
  url: https://github.com/http4s/http4s/security/advisories/GHSA-6h7w-fc84-x7p6
- type: FIX
  url: https://github.com/http4s/http4s/commit/52e1890665410b4385e37b96bc49c5e3c708e4e9
