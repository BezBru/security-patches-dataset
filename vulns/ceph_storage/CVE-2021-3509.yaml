schema_version: 1.2.0
id: CVE-2021-3509
aliases: []
modified: 2021-06-04T17:23Z
published: 2021-05-27T00:15Z
details: A flaw was found in Red Hat Ceph Storage 4, in the Dashboard component. In
  response to CVE-2020-27839, the JWT token was moved from localStorage to an httpOnly
  cookie. However, token cookies are used in the body of the HTTP response for the
  documentation, which again makes it available to XSS.The greatest threat to the
  system is for confidentiality, integrity, and availability.
severity:
- type: CVSS_V3
  score: 6.1
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: ceph_storage
    cpe: cpe:2.3:a:redhat:ceph_storage
- ranges:
  - type: GIT
    repo: https://github.com/ceph/ceph
    events:
    - introduced: '0'
    - fixed: adda853e64bdba1288d46bc7d462d23d8f2f10ca
  - type: GIT
    repo: https://github.com/ceph/ceph
    events:
    - introduced: '0'
    - fixed: 7a1ca8d372da3b6a4fc3d221a0e5f72d1d61c27b
  - type: GIT
    repo: https://github.com/ceph/ceph
    events:
    - introduced: '0'
    - fixed: af3fffab3b0f13057134d96e5d481e400d8bfd27
- versions:
  - '4.0'
- database_specific:
    CWE:
    - CWE-79
    CVSS:
      Score: 6.1
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
references:
- type: FIX
  url: https://github.com/ceph/ceph/commit/adda853e64bdba1288d46bc7d462d23d8f2f10ca
- type: WEB
  url: https://github.com/ceph/ceph/blob/f1557e8f62d31883d3d34ae241a1a26af11d923f/src/pybind/mgr/dashboard/controllers/docs.py#L394-L409
- type: FIX
  url: https://github.com/ceph/ceph/commit/7a1ca8d372da3b6a4fc3d221a0e5f72d1d61c27b
- type: REPORT
  url: https://bugzilla.redhat.com/show_bug.cgi?id=1950116
- type: FIX
  url: https://github.com/ceph/ceph/commit/af3fffab3b0f13057134d96e5d481e400d8bfd27
