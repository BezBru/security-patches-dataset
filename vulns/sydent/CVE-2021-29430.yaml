schema_version: 1.2.0
id: CVE-2021-29430
aliases:
- GHSA-wmg4-8cp2-hpg9
modified: 2021-04-22T17:19Z
published: 2021-04-15T21:15Z
details: Sydent is a reference Matrix identity server. Sydent does not limit the size
  of requests it receives from HTTP clients. A malicious user could send an HTTP request
  with a very large body, leading to memory exhaustion and denial of service. Sydent
  also does not limit response size for requests it makes to remote Matrix homeservers.
  A malicious homeserver could return a very large response, again leading to memory
  exhaustion and denial of service. This affects any server which accepts registration
  requests from untrusted clients. This issue has been patched by releases 89071a1,
  0523511, f56eee3. As a workaround request sizes can be limited in an HTTP reverse-proxy.
  There are no known workarounds for the problem with overlarge responses.
severity:
- type: CVSS_V3
  score: 7.5
- type: CVSS_V2
  score: 5.0
affected:
- package:
    name: sydent
    cpe: cpe:2.3:a:matrix:sydent
- ranges:
  - type: GIT
    repo: https://github.com/matrix-org/sydent
    events:
    - introduced: '0'
    - fixed: 0523511d2fb40f2738f8a8549868f44b96e5dab7
  - type: GIT
    repo: https://github.com/matrix-org/sydent
    events:
    - introduced: '0'
    - fixed: f56eee315b6c44fdd9f6aa785cc2ec744a594428
  - type: GIT
    repo: https://github.com/matrix-org/sydent
    events:
    - introduced: '0'
    - fixed: 89071a1a754c69a50deac89e6bb74002d4cda19d
- database_specific:
    CWE:
    - CWE-20
    - CWE-400
    CVSS:
      Score: 7.5
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
references:
- type: WEB
  url: https://pypi.org/project/matrix-sydent/
- type: FIX
  url: https://github.com/matrix-org/sydent/commit/0523511d2fb40f2738f8a8549868f44b96e5dab7
- type: WEB
  url: https://github.com/matrix-org/sydent/releases/tag/v2.3.0
- type: FIX
  url: https://github.com/matrix-org/sydent/commit/f56eee315b6c44fdd9f6aa785cc2ec744a594428
- type: ADVISORY
  url: https://github.com/matrix-org/sydent/security/advisories/GHSA-wmg4-8cp2-hpg9
- type: FIX
  url: https://github.com/matrix-org/sydent/commit/89071a1a754c69a50deac89e6bb74002d4cda19d
