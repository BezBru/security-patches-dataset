schema_version: 1.2.0
id: CVE-2021-21241
aliases:
- GHSA-hh7m-rx4f-4vpv
modified: 2021-01-19T15:43Z
published: 2021-01-11T21:15Z
details: The Python "Flask-Security-Too" package is used for adding security features
  to your Flask application. It is an is a independently maintained version of Flask-Security
  based on the 3.0.0 version of Flask-Security. In Flask-Security-Too from version
  3.3.0 and before version 3.4.5, the /login and /change endpoints can return the
  authenticated user's authentication token in response to a GET request. Since GET
  requests aren't protected with a CSRF token, this could lead to a malicious 3rd
  party site acquiring the authentication token. Version 3.4.5 and version 4.0.0 are
  patched. As a workaround, if you aren't using authentication tokens - you can set
  the SECURITY_TOKEN_MAX_AGE to "0" (seconds) which should make the token unusable.
severity:
- type: CVSS_V3
  score: 7.4
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: flask-security-too
    cpe: cpe:2.3:a:flask-security-too_project:flask-security-too
- ranges:
  - type: GIT
    repo: https://github.com/Flask-Middleware/flask-security
    events:
    - introduced: '0'
    - fixed: 6d50ee9169acf813257c37b75babe9c28e83542a
  - type: GIT
    repo: https://github.com/Flask-Middleware/flask-security
    events:
    - introduced: '0'
    - fixed: 61d313150b5f620d0b800896c4f2199005e84b1f
- database_specific:
    CWE:
    - CWE-352
    CVSS:
      Score: 7.4
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
references:
- type: WEB
  url: https://pypi.org/project/Flask-Security-Too
- type: FIX
  url: https://github.com/Flask-Middleware/flask-security/commit/6d50ee9169acf813257c37b75babe9c28e83542a
- type: FIX
  url: https://github.com/Flask-Middleware/flask-security/commit/61d313150b5f620d0b800896c4f2199005e84b1f
- type: WEB
  url: https://github.com/Flask-Middleware/flask-security/pull/422
- type: WEB
  url: https://github.com/Flask-Middleware/flask-security/releases/tag/3.4.5
- type: ADVISORY
  url: https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-hh7m-rx4f-4vpv
