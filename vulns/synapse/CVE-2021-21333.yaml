schema_version: 1.2.0
id: CVE-2021-21333
aliases:
- GHSA-c5f8-35qr-q4fm
modified: 2021-11-23T22:32Z
published: 2021-03-26T20:15Z
details: Synapse is a Matrix reference homeserver written in python (pypi package
  matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and
  VoIP. In Synapse before version 1.27.0, the notification emails sent for notifications
  for missed messages or for an expiring account are subject to HTML injection. In
  the case of the notification for missed messages, this could allow an attacker to
  insert forged content into the email. The account expiry feature is not enabled
  by default and the HTML injection is not controllable by an attacker. This is fixed
  in version 1.27.0.
severity:
- type: CVSS_V3
  score: 6.1
- type: CVSS_V2
  score: 2.6
affected:
- package:
    name: synapse
    cpe: cpe:2.3:a:matrix:synapse
- ranges:
  - type: GIT
    repo: https://github.com/matrix-org/synapse
    events:
    - introduced: '0'
    - fixed: e54746bdf7d5c831eabe4dcea76a7626f1de73df
- database_specific:
    CWE:
    - CWE-74
    - CWE-74
    CVSS:
      Score: 6.1
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N
references:
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY/
- type: FIX
  url: https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df
- type: WEB
  url: https://github.com/matrix-org/synapse/releases/tag/v1.27.0
- type: ADVISORY
  url: https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm
- type: WEB
  url: https://github.com/matrix-org/synapse/pull/9200
