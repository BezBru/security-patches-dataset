schema_version: 1.2.0
id: CVE-2021-41138
aliases:
- GHSA-vj62-g63v-f8mf
modified: 2021-10-20T16:45Z
published: 2021-10-13T16:15Z
details: Frontier is Substrate's Ethereum compatibility layer. In the newly introduced
  signed Frontier-specific extrinsic for `pallet-ethereum`, a large part of transaction
  validation logic was only called in transaction pool validation, but not in block
  execution. Malicious validators can take advantage of this to put invalid transactions
  into a block. The attack is limited in that the signature is always validated, and
  the majority of the validation is done again in the subsequent `pallet-evm` execution
  logic. However, do note that a chain ID replay attack was possible. In addition,
  spamming attacks are of main concerns, while they are limited by Substrate block
  size limits and other factors. The issue is patched in commit `146bb48849e5393004be5c88beefe76fdf009aba`.
severity:
- type: CVSS_V3
  score: 5.3
- type: CVSS_V2
  score: 5.0
affected:
- package:
    name: frontier
    cpe: cpe:2.3:a:parity:frontier
- ranges:
  - type: GIT
    repo: https://github.com/paritytech/frontier
    events:
    - introduced: '0'
    - fixed: 146bb48849e5393004be5c88beefe76fdf009aba
- database_specific:
    CWE:
    - CWE-20
    CVSS:
      Score: 5.3
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
references:
- type: WEB
  url: https://github.com/paritytech/frontier/pull/497
- type: ADVISORY
  url: https://github.com/paritytech/frontier/security/advisories/GHSA-vj62-g63v-f8mf
- type: FIX
  url: https://github.com/paritytech/frontier/commit/146bb48849e5393004be5c88beefe76fdf009aba
