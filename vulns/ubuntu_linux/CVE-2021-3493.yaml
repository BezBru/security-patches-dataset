schema_version: 1.2.0
id: CVE-2021-3493
aliases: []
modified: 2021-12-16T18:38Z
published: 2021-04-17T05:15Z
details: The overlayfs implementation in the linux kernel did not properly validate
  with respect to user namespaces the setting of file capabilities on files in an
  underlying file system. Due to the combination of unprivileged user namespaces along
  with a patch carried in the Ubuntu kernel to allow unprivileged overlay mounts,
  an attacker could use this to gain elevated privileges.
severity:
- type: CVSS_V3
  score: 7.8
- type: CVSS_V2
  score: 7.2
affected:
- package:
    name: ubuntu_linux
    cpe: cpe:2.3:o:canonical:ubuntu_linux
- ranges:
  - type: GIT
    repo: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git
    events:
    - introduced: '0'
    - fixed: 7c03e2cda4a584cadc398e8f6641ca9988a39d52
- database_specific:
    CWE:
    - CWE-269
    CVSS:
      Score: 7.8
      Severity: HIGH
      Code: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
references:
- type: WEB
  url: http://packetstormsecurity.com/files/165151/Ubuntu-Overlayfs-Local-Privilege-Escalation.html
- type: WEB
  url: http://packetstormsecurity.com/files/162866/Ubuntu-OverlayFS-Local-Privilege-Escalation.html
- type: WEB
  url: http://packetstormsecurity.com/files/162434/Kernel-Live-Patch-Security-Notice-LSN-0076-1.html
- type: WEB
  url: https://www.openwall.com/lists/oss-security/2021/04/16/1
- type: FIX
  url: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=7c03e2cda4a584cadc398e8f6641ca9988a39d52
- type: WEB
  url: https://ubuntu.com/security/notices/USN-4917-1
