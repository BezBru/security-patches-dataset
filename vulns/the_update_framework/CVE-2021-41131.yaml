schema_version: 1.2.0
id: CVE-2021-41131
aliases:
- GHSA-wjw6-2cqr-j4qr
modified: 2021-10-22T20:44Z
published: 2021-10-19T18:15Z
details: 'python-tuf is a Python reference implementation of The Update Framework
  (TUF). In both clients (`tuf/client` and `tuf/ngclient`), there is a path traversal
  vulnerability that in the worst case can overwrite files ending in `.json` anywhere
  on the client system on a call to `get_one_valid_targetinfo()`. It occurs because
  the rolename is used to form the filename, and may contain path traversal characters
  (ie `../../name.json`). The impact is mitigated by a few facts: It only affects
  implementations that allow arbitrary rolename selection for delegated targets metadata,
  The attack requires the ability to A) insert new metadata for the path-traversing
  role and B) get the role delegated by an existing targets metadata, The written
  file content is heavily restricted since it needs to be a valid, signed targets
  file. The file extension is always .json. A fix is available in version 0.19 or
  newer. There are no workarounds that do not require code changes. Clients can restrict
  the allowed character set for rolenames, or they can store metadata in files named
  in a way that is not vulnerable: neither of these approaches is possible without
  modifying python-tuf.'
severity:
- type: CVSS_V3
  score: 8.7
- type: CVSS_V2
  score: 8.8
affected:
- package:
    name: the_update_framework
    cpe: cpe:2.3:a:linuxfoundation:the_update_framework
- ranges:
  - type: GIT
    repo: https://github.com/theupdateframework/python-tuf
    events:
    - introduced: '0'
    - fixed: 4ad7ae48fda594b640139c3b7eae21ed5155a102
- database_specific:
    CWE:
    - CWE-22
    CVSS:
      Score: 8.7
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:H
references:
- type: FIX
  url: https://github.com/theupdateframework/python-tuf/commit/4ad7ae48fda594b640139c3b7eae21ed5155a102
- type: REPORT
  url: https://github.com/theupdateframework/python-tuf/issues/1527
- type: ADVISORY
  url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-wjw6-2cqr-j4qr
