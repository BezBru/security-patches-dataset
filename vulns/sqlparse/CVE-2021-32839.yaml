schema_version: 1.2.0
id: CVE-2021-32839
aliases:
- GHSA-p5w8-wqhj-9hhf
modified: 2021-09-29T15:04Z
published: 2021-09-20T17:15Z
details: sqlparse is a non-validating SQL parser module for Python. In sqlparse versions
  0.4.0 and 0.4.1 there is a regular Expression Denial of Service in sqlparse vulnerability.
  The regular expression may cause exponential backtracking on strings containing
  many repetitions of '\r\n' in SQL comments. Only the formatting feature that removes
  comments from SQL statements is affected by this regular expression. As a workaround
  don't use the sqlformat.format function with keyword strip_comments=True or the
  --strip-comments command line flag when using the sqlformat command line tool. The
  issues has been fixed in sqlparse 0.4.2.
severity:
- type: CVSS_V3
  score: 7.5
- type: CVSS_V2
  score: 5.0
affected:
- package:
    name: sqlparse
    cpe: cpe:2.3:a:sqlparse_project:sqlparse
- ranges:
  - type: GIT
    repo: https://github.com/andialbrecht/sqlparse
    events:
    - introduced: '0'
    - fixed: 8238a9e450ed1524e40cb3a8b0b3c00606903aeb
- database_specific:
    CWE:
    - CWE-400
    CVSS:
      Score: 7.5
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
references:
- type: ADVISORY
  url: https://github.com/andialbrecht/sqlparse/security/advisories/GHSA-p5w8-wqhj-9hhf
- type: FIX
  url: https://github.com/andialbrecht/sqlparse/commit/8238a9e450ed1524e40cb3a8b0b3c00606903aeb
