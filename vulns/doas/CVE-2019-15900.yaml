schema_version: 1.2.0
id: CVE-2019-15900
aliases: []
modified: 2021-07-21T11:39Z
published: 2019-10-18T16:15Z
details: An issue was discovered in slicer69 doas before 6.2 on certain platforms
  other than OpenBSD. On platforms without strtonum(3), sscanf was used without checking
  for error cases. Instead, the uninitialized variable errstr was checked and in some
  cases returned success even if sscanf failed. The result was that, instead of reporting
  that the supplied username or group name did not exist, it would execute the command
  as root.
severity:
- type: CVSS_V3
  score: 9.8
- type: CVSS_V2
  score: 10.0
affected:
- package:
    name: doas
    cpe: cpe:2.3:a:doas_project:doas
- ranges:
  - type: GIT
    repo: https://github.com/slicer69/doas
    events:
    - introduced: '0'
    - fixed: 2f83222829448e5bc4c9391d607ec265a1e06531
- database_specific:
    CWE:
    - CWE-754
    - CWE-863
    - CWE-908
    CVSS:
      Score: 9.8
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
- type: FIX
  url: https://github.com/slicer69/doas/commit/2f83222829448e5bc4c9391d607ec265a1e06531
- type: WEB
  url: https://github.com/slicer69/doas/compare/6.1p1...6.2
