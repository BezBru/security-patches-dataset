schema_version: 1.2.0
id: CVE-2021-41267
aliases:
- GHSA-q3j3-w37x-hq2q
modified: 2021-11-30T18:52Z
published: 2021-11-24T19:15Z
details: Symfony/Http-Kernel is the HTTP kernel component for Symfony, a PHP framework
  for web and console applications and a set of reusable PHP components. Headers that
  are not part of the "trusted_headers" allowed list are ignored and protect users
  from "Cache poisoning" attacks. In Symfony 5.2, maintainers added support for the
  `X-Forwarded-Prefix` headers, but this header was accessible in SubRequest, even
  if it was not part of the "trusted_headers" allowed list. An attacker could leverage
  this opportunity to forge requests containing a `X-Forwarded-Prefix` header, leading
  to a web cache poisoning issue. Versions 5.3.12 and later have a patch to ensure
  that the `X-Forwarded-Prefix` header is not forwarded to subrequests when it is
  not trusted.
severity:
- type: CVSS_V3
  score: 6.5
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: symfony
    cpe: cpe:2.3:a:sensiolabs:symfony
- ranges:
  - type: GIT
    repo: https://github.com/symfony/symfony
    events:
    - introduced: '0'
    - fixed: 95dcf51682029e89450aee86267e3d553aa7c487
- database_specific:
    CWE:
    - CWE-444
    CVSS:
      Score: 6.5
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
references:
- type: FIX
  url: https://github.com/symfony/symfony/commit/95dcf51682029e89450aee86267e3d553aa7c487
- type: ADVISORY
  url: https://github.com/symfony/symfony/security/advisories/GHSA-q3j3-w37x-hq2q
- type: WEB
  url: https://github.com/symfony/symfony/pull/44243
- type: WEB
  url: https://github.com/symfony/symfony/releases/tag/v5.3.12
