schema_version: 1.2.0
id: CVE-2021-41088
aliases:
- GHSA-fpv6-f8jw-rc3r
modified: 2021-10-01T17:33Z
published: 2021-09-23T20:15Z
details: Elvish is a programming language and interactive shell, combined into one
  package. In versions prior to 0.14.0 Elvish's web UI backend (started by `elvish
  -web`) hosts an endpoint that allows executing the code sent from the web UI. The
  backend does not check the origin of requests correctly. As a result, if the user
  has the web UI backend open and visits a compromised or malicious website, the website
  can send arbitrary code to the endpoint in localhost. All Elvish releases from 0.14.0
  onward no longer include the the web UI, although it is still possible for the user
  to build a version from source that includes the web UI. The issue can be patched
  for previous versions by removing the web UI (found in web, pkg/web or pkg/prog/web,
  depending on the exact version).
severity:
- type: CVSS_V3
  score: 8.8
- type: CVSS_V2
  score: 9.3
affected:
- package:
    name: elvish
    cpe: cpe:2.3:a:elv:elvish
- ranges:
  - type: GIT
    repo: https://github.com/elves/elvish
    events:
    - introduced: '0'
    - fixed: ccc2750037bbbfafe9c1b7a78eadd3bd16e81fe5
- database_specific:
    CWE:
    - CWE-668
    CVSS:
      Score: 8.8
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
references:
- type: FIX
  url: https://github.com/elves/elvish/commit/ccc2750037bbbfafe9c1b7a78eadd3bd16e81fe5
- type: ADVISORY
  url: https://github.com/elves/elvish/security/advisories/GHSA-fpv6-f8jw-rc3r
