schema_version: 1.2.0
id: CVE-2020-26287
aliases:
- GHSA-g6w6-7xf9-m95p
modified: 2020-12-30T16:50Z
published: 2020-12-29T00:15Z
details: HedgeDoc is a collaborative platform for writing and sharing markdown. In
  HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in
  HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading
  scripts from most locations, but `www.google-analytics.com` is allowed. Using Google
  Tag Manger it is possible to inject arbitrary JavaScript and execute it on page
  load. Depending on the configuration of the instance, the attacker may not need
  authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1.
  As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy`
  header. Note that other ways to leverage the `script` tag injection might exist.
severity:
- type: CVSS_V3
  score: 8.7
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: hedgedoc
    cpe: cpe:2.3:a:hedgedoc:hedgedoc
- ranges:
  - type: GIT
    repo: https://github.com/hedgedoc/hedgedoc
    events:
    - introduced: '0'
    - fixed: 58276ebbf4504a682454a3686dcaff88bc1069d4
- database_specific:
    CWE:
    - CWE-79
    CVSS:
      Score: 8.7
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
references:
- type: FIX
  url: https://github.com/hedgedoc/hedgedoc/commit/58276ebbf4504a682454a3686dcaff88bc1069d4
- type: WEB
  url: https://github.com/Alemmi/ctf-writeups/blob/main/hxpctf-2020/hackme/solution.md
- type: ADVISORY
  url: https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-g6w6-7xf9-m95p
- type: REPORT
  url: https://github.com/hackmdio/codimd/issues/1630
- type: WEB
  url: https://github.com/hedgedoc/hedgedoc/releases/tag/1.7.1
