schema_version: 1.2.0
id: CVE-2021-33564
aliases: []
modified: 2021-06-10T15:20Z
published: 2021-05-29T14:15Z
details: An argument injection vulnerability in the Dragonfly gem before 1.4.0 for
  Ruby allows remote attackers to read and write to arbitrary files via a crafted
  URL when the verify_url option is disabled. This may lead to code execution. The
  problem occurs because the generate and process features mishandle use of the ImageMagick
  convert utility.
severity:
- type: CVSS_V3
  score: 9.8
- type: CVSS_V2
  score: 6.8
affected:
- package:
    name: dragonfly
    cpe: cpe:2.3:a:dragonfly_project:dragonfly
- ranges:
  - type: GIT
    repo: https://github.com/markevans/dragonfly
    events:
    - introduced: '0'
    - fixed: 25399297bb457f7fcf8e3f91e85945b255b111b5
- database_specific:
    CWE:
    - CWE-88
    CVSS:
      Score: 9.8
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
- type: WEB
  url: https://github.com/mlr0p/CVE-2021-33564
- type: FIX
  url: https://github.com/markevans/dragonfly/commit/25399297bb457f7fcf8e3f91e85945b255b111b5
- type: WEB
  url: https://github.com/markevans/dragonfly/compare/v1.3.0...v1.4.0
- type: REPORT
  url: https://github.com/markevans/dragonfly/issues/513
- type: WEB
  url: https://zxsecurity.co.nz/research/argunment-injection-ruby-dragonfly/
- type: WEB
  url: https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/master/cves/2021/CVE-2021-33564.yaml
