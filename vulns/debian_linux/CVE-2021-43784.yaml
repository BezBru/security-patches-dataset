schema_version: 1.2.0
id: CVE-2021-43784
aliases:
- GHSA-v95c-p5hm-xq8f
modified: 2021-12-08T18:05Z
published: 2021-12-06T18:15Z
details: runc is a CLI tool for spawning and running containers on Linux according
  to the OCI specification. In runc, netlink is used internally as a serialization
  system for specifying the relevant container configuration to the `C` portion of
  the code (responsible for the based namespace setup of containers). In all versions
  of runc prior to 1.0.3, the encoder did not handle the possibility of an integer
  overflow in the 16-bit length field for the byte array attribute type, meaning that
  a large enough malicious byte array attribute could result in the length overflowing
  and the attribute contents being parsed as netlink messages for container configuration.
  This vulnerability requires the attacker to have some control over the configuration
  of the container and would allow the attacker to bypass the namespace restrictions
  of the container by simply adding their own netlink payload which disables all namespaces.
  The main users impacted are those who allow untrusted images with untrusted configurations
  to run on their machines (such as with shared cloud infrastructure). runc version
  1.0.3 contains a fix for this bug. As a workaround, one may try disallowing untrusted
  namespace paths from your container. It should be noted that untrusted namespace
  paths would allow the attacker to disable namespace protections entirely even in
  the absence of this bug.
severity:
- type: CVSS_V3
  score: 5.0
- type: CVSS_V2
  score: 6.0
affected:
- package:
    name: debian_linux
    cpe: cpe:2.3:o:debian:debian_linux
- ranges:
  - type: GIT
    repo: https://github.com/opencontainers/runc
    events:
    - introduced: '0'
    - fixed: f50369af4b571e358f20b139eea52d612eb55eed
  - type: GIT
    repo: https://github.com/opencontainers/runc
    events:
    - introduced: '0'
    - fixed: d72d057ba794164c3cce9451a00b72a78b25e1ae
  - type: GIT
    repo: https://github.com/opencontainers/runc
    events:
    - introduced: '0'
    - fixed: 9c444070ec7bb83995dbc0185da68284da71c554
- versions:
  - '9.0'
- database_specific:
    CWE:
    - CWE-190
    CVSS:
      Score: 5.0
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
references:
- type: FIX
  url: https://github.com/opencontainers/runc/commit/f50369af4b571e358f20b139eea52d612eb55eed
- type: WEB
  url: https://lists.debian.org/debian-lts-announce/2021/12/msg00005.html
- type: ADVISORY
  url: https://github.com/opencontainers/runc/security/advisories/GHSA-v95c-p5hm-xq8f
- type: FIX
  url: https://github.com/opencontainers/runc/commit/d72d057ba794164c3cce9451a00b72a78b25e1ae
- type: REPORT
  url: https://bugs.chromium.org/p/project-zero/issues/detail?id=2241
- type: FIX
  url: https://github.com/opencontainers/runc/commit/9c444070ec7bb83995dbc0185da68284da71c554
