schema_version: 1.2.0
id: CVE-2021-21300
aliases:
- GHSA-8prw-h3cq-mghm
modified: 2021-09-23T12:45Z
published: 2021-03-09T20:15Z
details: 'Git is an open-source distributed revision control system. In affected versions
  of Git a specially crafted repository that contains symbolic links as well as files
  using a clean/smudge filter such as Git LFS, may cause just-checked out script to
  be executed while cloning onto a case-insensitive file system such as NTFS, HFS+
  or APFS (i.e. the default file systems on Windows and macOS). Note that clean/smudge
  filters have to be configured for that. Git for Windows configures Git LFS by default,
  and is therefore vulnerable. The problem has been patched in the versions published
  on Tuesday, March 9th, 2021. As a workaound, if symbolic link support is disabled
  in Git (e.g. via `git config --global core.symlinks false`), the described attack
  won''t work. Likewise, if no clean/smudge filters such as Git LFS are configured
  globally (i.e. _before_ cloning), the attack is foiled. As always, it is best to
  avoid cloning repositories from untrusted sources. The earliest impacted version
  is 2.14.2. The fix versions are: 2.30.1, 2.29.3, 2.28.1, 2.27.1, 2.26.3, 2.25.5,
  2.24.4, 2.23.4, 2.22.5, 2.21.4, 2.20.5, 2.19.6, 2.18.5, 2.17.62.17.6.'
severity:
- type: CVSS_V3
  score: 7.5
- type: CVSS_V2
  score: 5.1
affected:
- package:
    name: git
    cpe: cpe:2.3:a:git-scm:git
- ranges:
  - type: GIT
    repo: https://github.com/git/git
    events:
    - introduced: '0'
    - fixed: 684dd4c2b414bcf648505e74498a608f28de4592
- versions:
  - 2.28.0
  - 2.27.0
- database_specific:
    CWE:
    - CWE-59
    CVSS:
      Score: 7.5
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
references:
- type: WEB
  url: https://lore.kernel.org/git/xmqqim6019yd.fsf@gitster.c.googlers.com/
- type: WEB
  url: https://support.apple.com/kb/HT212320
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LCLJJLKKMS5WRFO6C475AOUZTWQLIARX/
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BBPNGLQSYJHLZZ37BO42YY6S5OTIF4L4/
- type: WEB
  url: https://git-scm.com/docs/gitattributes#_filter
- type: FIX
  url: https://github.com/git/git/commit/684dd4c2b414bcf648505e74498a608f28de4592
- type: ADVISORY
  url: https://github.com/git/git/security/advisories/GHSA-8prw-h3cq-mghm
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LMXX2POK5X576BSDWSXGU7EIK6I72ERU/
- type: WEB
  url: https://security.gentoo.org/glsa/202104-01
- type: WEB
  url: http://www.openwall.com/lists/oss-security/2021/03/09/3
- type: WEB
  url: http://seclists.org/fulldisclosure/2021/Apr/60
- type: WEB
  url: http://packetstormsecurity.com/files/163978/Git-LFS-Clone-Command-Execution.html
- type: WEB
  url: https://git-scm.com/docs/git-config#Documentation/git-config.txt-coresymlinks
