#!/bin/bash
PYTHON=python3
DATA_FOLDER=../data/cve-details
RAW_DATA_FILENAME=raw-cve-details-data.csv
PATCHES_DATA_FILENAME=all-cve-details-patches.csv

echo "Merging data scraped per year from the cve details database..."
$PYTHON merge_data.py -folder $DATA_FOLDER/year/ \
                            -fout $DATA_FOLDER/$RAW_DATA_FILENAME

echo "\nGetting the patches with references to github, bitbucket and gitlab..."
$PYTHON patches.py --task filter \
                                -fin $DATA_FOLDER/$RAW_DATA_FILENAME \
                                -fout $DATA_FOLDER/$PATCHES_DATA_FILENAME

echo "\nCleaning the data..."
$PYTHON clean.py -f $DATA_FOLDER/$PATCHES_DATA_FILENAME 

# echo "\nGenerating data statistics..."
# $PYTHON patches.py --task stats  \
#                                 -fin $DATA_FOLDER/$REFS_DATA_FILENAME
                     